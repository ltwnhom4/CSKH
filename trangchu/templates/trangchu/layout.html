<!DOCTYPE html>
{% load static %}
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Punky Spa</title>

    <!-- ğŸŒ¸ LiÃªn káº¿t CSS -->
    <link rel="stylesheet" href="{% static 'trangchu/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<!-- ğŸ¾ Hiá»‡u á»©ng chÃ¢n mÃ¨o rÆ¡i -->
<div class="paw-fall"></div>

<script>
  const pawFallContainer = document.querySelector(".paw-fall");
  const pawSrc = "{% static 'trangchu/chanmeo.png' %}"; // áº£nh báº¡n Ä‘Ã£ gá»­i nha

  function createPaw() {
    const paw = document.createElement("img");
    paw.src = pawSrc;
    paw.classList.add("paw-item");

    // vá»‹ trÃ­ & kÃ­ch thÆ°á»›c ngáº«u nhiÃªn
    paw.style.left = Math.random() * 100 + "vw";
    paw.style.width = 25 + Math.random() * 20 + "px";
    paw.style.animationDuration = 5 + Math.random() * 4 + "s";
    paw.style.opacity = 0.6 + Math.random() * 0.4;

    pawFallContainer.appendChild(paw);

    // xÃ³a khi rÆ¡i xong
    setTimeout(() => paw.remove(), 9000);
  }

  setInterval(createPaw, 500); // cá»© 0.5s rÆ¡i 1 dáº¥u chÃ¢n
</script>

<body>

    <!-- ğŸŒ¸ THANH TRÃŠN CÃ™NG -->
    <div class="topbar">
        <div class="topbar-left">
            <i class="fa fa-calendar"></i>
            <strong>Giá» lÃ m viá»‡c:</strong> Tá»« 09h00 Ä‘áº¿n 21h00
        </div>

        <div class="right">
            {% if user.is_authenticated %}
            <!-- ğŸ”” Náº¿u Ä‘Ã£ Ä‘Äƒng nháº­p -->
            <div class="notify-box">
                <span class="notify-icon">ğŸ””</span>
                <div class="notify-content">
                    {% for tb in thong_baos_moi %}
                        <div class="notify-item">
                            <strong>{{ tb.tieu_de }}</strong><br>
                            <small>{{ tb.ngay_tao|date:"d/m/Y H:i" }}</small>
                        </div>
                    {% empty %}
                        <p>KhÃ´ng cÃ³ thÃ´ng bÃ¡o má»›i.</p>
                    {% endfor %}
                    <a href="{% url 'TB:danh_sach_thong_bao' %}" class="view-all">Xem táº¥t cáº£</a>
                </div>
            </div>

           <!-- MENU TAI KHOAN -->
            <div class="user-menu">
                <button class="user-btn">
                    <i class="fa fa-user"></i> {{ user.username }}
                    <i class="fa fa-caret-down"></i>
                </button>

                <div class="dropdown-menu">
                    <a href="{% url 'thongtintaikhoan' %}"><i class="fa fa-star"></i> TÃ i khoáº£n</a>
                    <a href="#"><i class="fa fa-star"></i> TÃ­ch Ä‘iá»ƒm</a>
                    <a href="#"><i class="fa fa-ticket"></i> MÃ£ Æ°u Ä‘Ã£i</a>
                    <a href="{% url 'lich_hen_sap_toi' %}"><i class="fa fa-calendar"></i> Lá»‹ch háº¹n</a>
                    <a href="#"><i class="fa fa-comments"></i> Khiáº¿u náº¡i</a>
                    <a href="{% url 'dangxuat' %}"><i class="fa fa-sign-out-alt"></i> ÄÄƒng xuáº¥t</a>
                    <a href="#"><i class="fa fa-trash"></i> XÃ³a tÃ i khoáº£n</a>
                </div>
            </div>

            {% else %}
            <!-- ğŸ”¹ Náº¿u chÆ°a Ä‘Äƒng nháº­p -->
            <div class="notify-box">
                <span class="notify-icon">ğŸ””</span>
                <div class="notify-content">
                    <div style="text-align:center; padding:15px;">
                        <img src="{% static 'trangchu/notify-cat .png' %}" alt="MÃ¨o dá»… thÆ°Æ¡ng" class="notify-image">
                        <p>ÄÄƒng nháº­p Ä‘á»ƒ xem thÃ´ng bÃ¡o</p>
                        <a href="{% url 'dangnhap' %}" class="btn">ÄÄƒng nháº­p</a>
                        <a href="{% url 'dangky' %}" class="btn">ÄÄƒng kÃ½</a>
                    </div>
                </div>
            </div>
            <a href="{% url 'dangnhap' %}">ÄÄƒng nháº­p</a> |
            <a href="{% url 'dangky' %}">ÄÄƒng kÃ½</a>
            {% endif %}
        </div>
    </div>

    <!-- ğŸŒ¸ HEADER CHÃNH -->
    <header class="navbar">
        <div class="logo">
            <img src="{% static 'trangchu/logo.png' %}" alt="Logo Punky Spa">
            <h1><span class="pink">Punky</span> Spa</h1>
        </div>

        <nav>
            <a href="{% url 'home' %}" class="{% if request.resolver_match.url_name == 'home' %}active{% endif %}">Trang chá»§</a>
            <a href="{% url 'danh_sach_dich_vu' %}" class="{% if request.resolver_match.url_name == 'danh_sach_dich_vu' %}active{% endif %}">Dá»‹ch vá»¥</a>
            <a href="{% url 'TB:danh_sach_khuyen_mai' %}"class="nav-link {% if request.resolver_match.url_name == 'danh_sach_khuyen_mai' %}active{% endif %}">Khuyáº¿n mÃ£i</a>
            <a href="{% url 'lien_he' %}" class="{% if request.resolver_match.url_name == 'lien_he' %}active{% endif %}">LiÃªn há»‡</a>

        </nav>

        <div class="search">
            <input type="text" placeholder="TÃ¬m kiáº¿m...">
            <button>ğŸ”</button>
        </div>
    </header>


    {% block content %}{% endblock %}

    <!-- ğŸŒ¸ FOOTER -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-column">
                <h4>LiÃªn láº¡c</h4>
                <p>Hotline: 1900 6750</p>
                <p>Äá»‹a chá»‰: 627 NgÃ´ Quyá»n, An Háº£i Báº¯c,<br>ÄÃ  Náºµng, Viá»‡t Nam</p>
            </div>

            <div class="footer-column">
                <h4>ChÃ­nh sÃ¡ch</h4>
                <p>ChÃ­nh sÃ¡ch báº£o máº­t</p>
                <p>Quy Ä‘á»‹nh sá»­ dá»¥ng</p>
            </div>

            <div class="footer-column">
                <h4>Tá»•ng Ä‘Ã i há»— trá»£</h4>
                <p>TÆ° váº¥n dá»‹ch vá»¥: 1800 6750</p>
                <p>Há»— trá»£ sá»­ dá»¥ng: 1900 6750</p>
                <p>Email: punkyspa@gmail.vn</p>
                <p>Tá»« 7h00 â€“ 20h00 cÃ¡c ngÃ y tá»« thá»© 2 Ä‘áº¿n Chá»§ nháº­t.</p>
            </div>
        </div>
    </footer>

    <!-- ğŸŒ¸ NÃºt gá»i vÃ  Chat -->
    <div class="floating-icons">
        <a href="tel:19006750" class="phone-icon" title="Gá»i ngay Punky Spa">
            <i class="fa fa-phone"></i>
        </a>
        <div class="chat-icon" id="chatToggle">
            <img src="{% static 'trangchu/logo.png' %}" alt="Chat Punky Spa">
        </div>
    </div>

    <!-- ğŸŒ¸ Chatbox -->
    <div class="chatbox" id="chatBox">
        <div class="chat-header">
            <img src="{% static 'trangchu/logo.png' %}" alt="Logo">
            <h4>Punky Spa há»— trá»£ ğŸ¾</h4>
            <span id="closeChat">âœ–</span>
        </div>

        <div class="chat-body" id="chatBody">
            <div class="message bot">
                Xin chÃ o ğŸ‘‹, chÃ o má»«ng báº¡n Ä‘Ã£ Ä‘áº¿n vá»›i <b>Punky Spa</b>!
                Báº¡n cáº§n Ä‘Æ°á»£c há»— trá»£ vá» dá»‹ch vá»¥ nÃ o áº¡?
                <div class="options">
                    <button onclick="sendOption('BÃ¡o giÃ¡ dá»‹ch vá»¥')">BÃ¡o giÃ¡ dá»‹ch vá»¥</button>
                    <button onclick="sendOption('Há»i Ä‘Ã¡p nhanh (FAQ)')">Há»i Ä‘Ã¡p nhanh</button>
                    <button onclick="sendOption('TÆ° váº¥n trá»±c tiáº¿p')">TÆ° váº¥n trá»±c tiáº¿p</button>
                </div>
            </div>
        </div>

        <!-- ğŸŒ¸ Ã” nháº­p tin nháº¯n -->
        <div class="chat-input-area">
            <input type="text" id="chat-input" placeholder="Nháº­p tin nháº¯n cá»§a báº¡n..." />
            <button id="chat-send"><i class="fa fa-paper-plane"></i></button>
        </div>
    </div>

    <!-- ğŸŒ¸ SCRIPT -->
    <script>
    const chatToggle = document.getElementById("chatToggle");
    const chatBox = document.getElementById("chatBox");
    const closeChat = document.getElementById("closeChat");
    const chatBody = document.getElementById("chatBody");
    const chatInput = document.getElementById("chat-input");
    const chatSend = document.getElementById("chat-send");

    chatToggle.addEventListener("click", () => chatBox.style.display = "block");
    closeChat.addEventListener("click", () => chatBox.style.display = "none");

    // ğŸ“¨ Gá»­i tin nháº¯n
    chatSend.addEventListener("click", sendMessage);
    chatInput.addEventListener("keypress", e => {
        if (e.key === "Enter") sendMessage();
    });

    function sendMessage() {
        const text = chatInput.value.trim();
        if (!text) return;
        appendMessage(text, "user");
        chatInput.value = "";
        setTimeout(() => appendMessage(getBotReply(text), "bot"), 700);
    }

    function appendMessage(content, sender) {
        const msg = document.createElement("div");
        msg.className = `message ${sender}`;
        msg.innerHTML = content;
        chatBody.appendChild(msg);
        chatBody.scrollTop = chatBody.scrollHeight;
    }

    function sendOption(option) {
        appendMessage(option, "user");

        // âš™ï¸ Náº¿u ngÆ°á»i dÃ¹ng chá»n BÃ¡o giÃ¡ dá»‹ch vá»¥ hoáº·c FAQ hoáº·c TÆ° váº¥n trá»±c tiáº¿p â†’ dÃ¹ng autoReply()
        if (
            option === "BÃ¡o giÃ¡ dá»‹ch vá»¥" ||
            option === "Há»i Ä‘Ã¡p nhanh (FAQ)" ||
            option === "TÆ° váº¥n trá»±c tiáº¿p"
        ) {
            setTimeout(() => appendMessage(autoReply(option), "bot"), 600);
        }
        // âš™ï¸ Náº¿u ngÆ°á»i dÃ¹ng chá»n má»™t dá»‹ch vá»¥ cá»¥ thá»ƒ â†’ gá»i getBotReply()
        else {
            setTimeout(() => appendMessage(getBotReply(option), "bot"), 600);
        }
    }

    function autoReply(option) {
        if (option === "BÃ¡o giÃ¡ dá»‹ch vá»¥") {
            return `
            Báº¡n muá»‘n xem bÃ¡o giÃ¡ cho dá»‹ch vá»¥ nÃ o?
            <div class='options'>
                <button onclick='sendOption("Táº¯m rá»­a")'>Táº¯m rá»­a</button>
                <button onclick='sendOption("Cáº¯t tá»‰a lÃ´ng")'>Cáº¯t tá»‰a lÃ´ng</button>
                <button onclick='sendOption("Nhuá»™m lÃ´ng")'>Nhuá»™m lÃ´ng</button>
                <button onclick='sendOption("TÆ° váº¥n sá»©c khá»e")'>TÆ° váº¥n sá»©c khá»e</button>
                <button onclick='sendOption("TiÃªm phÃ²ng")'>TiÃªm phÃ²ng</button>
                <button onclick='sendOption("Triá»‡t sáº£n")'>Triá»‡t sáº£n</button>
            </div>`;
        }

        if (option === "Há»i Ä‘Ã¡p nhanh (FAQ)") {
            return `
            ğŸ’¬ Báº¡n cÃ³ thá»ƒ há»i tÃ´i nhá»¯ng Ä‘iá»u sau:<br><br>
            ğŸ¶ â€œPunky Spa cÃ³ nháº­n chÃ³ mÃ¨o ngoÃ i giá» khÃ´ng?â€<br>
            ğŸ¾ â€œCÃ³ dá»‹ch vá»¥ chÄƒm sÃ³c táº¡i nhÃ  khÃ´ng?â€<br>
            ğŸ’– â€œSau khi táº¯m cÃ³ sáº¥y khÃ´ vÃ  cháº£i lÃ´ng khÃ´ng?â€<br>
            ğŸŒ¸ â€œCÃ³ Ä‘Æ°á»£c mang dáº§u gá»™i riÃªng cho bÃ© khÃ´ng?â€<br><br>
            Hoáº·c báº¡n cÃ³ thá»ƒ chá»n <b>TÆ° váº¥n trá»±c tiáº¿p</b> Ä‘á»ƒ Ä‘Æ°á»£c nhÃ¢n viÃªn há»— trá»£ thÃªm ğŸ’•`;
        }

        if (option === "TÆ° váº¥n trá»±c tiáº¿p") {
            return "ğŸ“ Báº¡n cÃ³ thá»ƒ gá»i ngay <b>1900 6750</b> Ä‘á»ƒ Ä‘Æ°á»£c nhÃ¢n viÃªn Punky Spa há»— trá»£ táº­n tÃ¬nh ğŸ’•";
        }

        return "Cáº£m Æ¡n báº¡n Ä‘Ã£ quan tÃ¢m Ä‘áº¿n Punky Spa ğŸ’–";
    }

    function getBotReply(text) {
        // ğŸ”¹ Chuáº©n hÃ³a text: viáº¿t thÆ°á»ng, bá» dáº¥u, bá» khoáº£ng tráº¯ng thá»«a
        text = text.trim().toLowerCase()
            .normalize("NFD")
            .replace(/[\u0300-\u036f]/g, "");

        // ğŸ¾ ThÃ´ng tin dá»‹ch vá»¥ chi tiáº¿t
        if (text.includes("tam")) {
            return `ğŸ± <b>Táº¯m rá»­a</b> cÃ³ giÃ¡ khoáº£ng <b>150,000 VND</b>.<br>
            Dá»‹ch vá»¥ táº¯m há»¯u cÆ¡ dá»‹u nháº¹, sáº¥y khÃ´ riÃªng vÃ  massage thÆ° giÃ£n.<br>
            <a href="/dichvu/6/" class="btn" style="margin-top:6px;">ğŸ‘‰ Xem chi tiáº¿t</a>`;
        }

        if (text.includes("cat") || text.includes("tia long")) {
            return `ğŸ© <b>Cáº¯t, tá»‰a lÃ´ng</b> cÃ³ giÃ¡ khoáº£ng <b>200,000 VND</b>.<br>
            Táº¡o kiá»ƒu lÃ´ng dá»… thÆ°Æ¡ng, sá»­ dá»¥ng dá»¥ng cá»¥ chuyÃªn nghiá»‡p.<br>
            <a href="/dichvu/2/" class="btn" style="margin-top:6px;">ğŸ‘‰ Xem chi tiáº¿t</a>`;
        }

        if (text.includes("nhuom")) {
            return `ğŸ¨ <b>Nhuá»™m lÃ´ng</b> cÃ³ giÃ¡ khoáº£ng <b>300,000 VND</b>.<br>
            MÃ u nhuá»™m an toÃ n, khÃ´ng Ä‘á»™c háº¡i â€“ cho bÃ© thÃªm ná»•i báº­t.<br>
            <a href="/dichvu/4/" class="btn" style="margin-top:6px;">ğŸ‘‰ Xem chi tiáº¿t</a>`;
        }

        if (text.includes("tu van") || text.includes("suc khoe")) {
            return `ğŸ¶ <b>TÆ° váº¥n sá»©c khá»e</b> cÃ³ giÃ¡ khoáº£ng <b>100,000 VND</b>.<br>
            BÃ¡c sÄ© thÃº y tÆ° váº¥n dinh dÆ°á»¡ng, chÄƒm sÃ³c da lÃ´ng Ä‘á»‹nh ká»³.<br>
            <a href="/dichvu/5/" class="btn" style="margin-top:6px;">ğŸ‘‰ Xem chi tiáº¿t</a>`;
        }

        if (text.includes("tiem") || text.includes("phong")) {
            return `ğŸ’‰ <b>TiÃªm phÃ²ng</b> cÃ³ giÃ¡ khoáº£ng <b>250,000 VND</b>.<br>
            Vaccine nháº­p kháº©u, theo dÃµi sá»©c khá»e ká»¹ lÆ°á»¡ng sau tiÃªm.<br>
            <a href="/dichvu/3/" class="btn" style="margin-top:6px;">ğŸ‘‰ Xem chi tiáº¿t</a>`;
        }

        if (text.includes("triet") || text.includes("san")) {
            return `ğŸ•â€ğŸ¦º <b>Triá»‡t sáº£n</b> cÃ³ giÃ¡ khoáº£ng <b>700,000 VND</b>.<br>
            Quy trÃ¬nh an toÃ n, vÃ´ trÃ¹ng, bÃ© há»“i phá»¥c nhanh chÃ³ng.<br>
            <a href="/dichvu/1/" class="btn" style="margin-top:6px;">ğŸ‘‰ Xem chi tiáº¿t</a>`;
        }

        // ğŸ’¬ CÃ¡c cÃ¢u há»i FAQ phá»• biáº¿n
        if (text.includes("meo") || text.includes("cho")) {
            return "Dáº¡ cÃ³ áº¡ ğŸ’• Punky Spa phá»¥c vá»¥ cáº£ chÃ³ vÃ  mÃ¨o â€” má»—i bÃ© Ä‘á»u Ä‘Æ°á»£c chÄƒm sÃ³c riÃªng ğŸ¶ğŸ±";
        }

        if (text.includes("ngoai gio")) {
            return "Spa má»Ÿ cá»­a tá»« <b>09h00 Ä‘áº¿n 21h00</b>. NgoÃ i giá», báº¡n cÃ³ thá»ƒ Ä‘áº·t lá»‹ch trÆ°á»›c Ä‘á»ƒ Ä‘Æ°á»£c phá»¥c vá»¥ ğŸ’•";
        }

        if (text.includes("tai nha")) {
            return "Hiá»‡n Punky Spa <b>chÆ°a há»— trá»£ chÄƒm sÃ³c táº¡i nhÃ </b> áº¡ ğŸ˜¿, nhÆ°ng báº¡n cÃ³ thá»ƒ Ä‘áº·t lá»‹ch vÃ  Ä‘Æ°á»£c Æ°u tiÃªn sá»›m nháº¥t ğŸ’•";
        }

        if (text.includes("say") || text.includes("cham soc sau tam")) {
            return "Dáº¡ cÃ³ áº¡ ğŸ’• Má»—i bÃ© sau khi táº¯m Ä‘á»u Ä‘Æ°á»£c sáº¥y khÃ´ riÃªng báº±ng mÃ¡y chuyÃªn dá»¥ng vÃ  cháº£i lÃ´ng nháº¹ nhÃ ng ğŸ¾";
        }

        if (text.includes("dat lich") || text.includes("hen truoc")) {
            return "Dáº¡ báº¡n cÃ³ thá»ƒ Ä‘áº·t lá»‹ch trÆ°á»›c qua website hoáº·c gá»i <b>1900 6750</b> Ä‘á»ƒ Ä‘Æ°á»£c Æ°u tiÃªn ğŸ•";
        }

        if (text.includes("dau goi")) {
            return "Punky Spa cÃ³ <b>dáº§u gá»™i há»¯u cÆ¡</b> dÃ nh cho da nháº¡y cáº£m, vÃ  báº¡n cÃ³ thá»ƒ mang dáº§u riÃªng cho bÃ© náº¿u muá»‘n ğŸŒ¿";
        }

        return "ğŸ’— Cáº£m Æ¡n báº¡n Ä‘Ã£ liÃªn há»‡ Punky Spa! Báº¡n cÃ³ thá»ƒ há»i vá» giÃ¡, dá»‹ch vá»¥, hoáº·c chá»n má»¥c 'BÃ¡o giÃ¡ dá»‹ch vá»¥' Ä‘á»ƒ biáº¿t thÃªm chi tiáº¿t nhÃ©.";
    }

    </script>
 <!-- ğŸŒ¸ SCRIPT DROPDOWN MENU NGÆ¯á»œI DÃ™NG -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    // ğŸ”¹ Toggle dropdown chÃ­nh (menu lyly)
    const userBtn = document.querySelector(".user-btn");
    const dropdown = document.querySelector(".dropdown-menu");
    if (userBtn) {
        userBtn.addEventListener("click", (e) => {
            e.stopPropagation();
            dropdown.classList.toggle("show");
        });

        // ğŸ”¹ Báº¥m ra ngoÃ i thÃ¬ Ä‘Ã³ng dropdown (trá»« khi Ä‘ang trong dropdown)
        document.addEventListener("click", (event) => {
            if (!dropdown.contains(event.target) && !userBtn.contains(event.target)) {
                dropdown.classList.remove("show");
            }
        });
    }

    // ğŸ”¹ Toggle submenu tÃ i khoáº£n (ná»™i dung cÃ¡ nhÃ¢n + thÃº cÆ°ng)
    const submenuToggle = document.querySelector(".submenu-toggle");
    const submenuItems = document.querySelector(".submenu-items");

    if (submenuToggle && submenuItems) {
        submenuToggle.addEventListener("click", function(e) {
            e.preventDefault();
            e.stopPropagation(); // ğŸ‘ˆ NGÄ‚N khÃ´ng cho Ä‘Ã³ng dropdown cha
            submenuItems.classList.toggle("show");
            submenuToggle.classList.toggle("active");
        });
    }
});
</script>

<!-- ğŸŒ¸ STYLE Bá»” SUNG -->
<style>
/* ğŸŒ¸ áº¨n submenu máº·c Ä‘á»‹nh */
.submenu-items {
  display: none;
  flex-direction: column;
  background: #fff;
  border-radius: 6px;
  margin-top: 5px;
  overflow: hidden;
  transition: max-height 0.3s ease;
}

/* ğŸŒ¸ Hiá»‡n submenu khi nháº¥n */
.submenu-items.show {
  display: flex !important;
}

/* ğŸŒ¸ Hiá»‡u á»©ng mÅ©i tÃªn xoay xuá»‘ng/up */
.submenu-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.submenu-toggle i.fa-caret-down {
  transition: transform 0.3s ease;
}

.submenu-toggle.active i.fa-caret-down {
  transform: rotate(180deg);
}
</style>

</body>
</html>
