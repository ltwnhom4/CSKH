{% extends 'base_lhkn.html' %}
{% load static %}
{% block title %}L·ªãch s·ª≠ khi·∫øu n·∫°i - Punky Spa{% endblock %}

{% block content %}
<div class="content-wrapper">
  <h2 class="page-title">L·ªäCH S·ª¨ KHI·∫æU N·∫†I</h2>

  <div class="table-container">
    <table class="schedule-table">
      <thead>
        <tr>
          <th>Th·ªùi gian</th>

          {% if request.user.is_staff or request.user.is_superuser %}
            <th>T√™n kh√°ch h√†ng</th>
            <th>SƒêT</th>
          {% endif %}

          <th>T√™n th√∫ c∆∞ng</th>
          <th>D·ªãch v·ª•</th>
          <th>Nh√¢n vi√™n ph·ª• tr√°ch</th>
          <th>L√Ω do khi·∫øu n·∫°i</th>
          <th>Minh ch·ª©ng</th>
          <th>Tr·∫°ng th√°i</th>
          <th>Ph·∫£n h·ªìi</th>
        </tr>
      </thead>

      <tbody>
        {% if khieu_nai_list %}
          {% for k in khieu_nai_list %}
          <tr>
            <td>{{ k.lich_hen.thoi_gian|date:"H:i d/m/Y" }}</td>

            {% if request.user.is_staff or request.user.is_superuser %}
              <td>{{ k.lich_hen.khach_hang.ho_ten }}</td>
              <td>{{ k.lich_hen.so_dien_thoai }}</td>
            {% endif %}

            <td>{{ k.lich_hen.thu_cung.ten_thucung }}</td>

            <td>
              {% for dv_lh in k.lich_hen.dv_lichhen_set.all %}
                {{ dv_lh.dich_vu.ten_dich_vu }}{% if not forloop.last %}, {% endif %}
              {% empty %}
                <em>Kh√¥ng c√≥</em>
              {% endfor %}
            </td>

            <td>
              {% if k.nhan_vien_phu_trach %}
                {{ k.nhan_vien_phu_trach.username }}
              {% else %}
                <em>Ch∆∞a ph√¢n c√¥ng</em>
              {% endif %}
            </td>

            <td>{{ k.noi_dung }}</td>

            <td>
              {% if k.minh_chung %}
                <a href="{{ k.minh_chung.url }}" target="_blank" class="link-view">Xem</a>
              {% else %}
                <em>-</em>
              {% endif %}
            </td>

            <td>
              {% if k.trang_thai == "Ch·ªù x·ª≠ l√Ω" %}
                <span class="status wait">üïì {{ k.trang_thai }}</span>
              {% elif k.trang_thai == "ƒêang x·ª≠ l√Ω" %}
                <span class="status processing">üî¥ {{ k.trang_thai }}</span>
              {% else %}
                <span class="status done">‚úÖ {{ k.trang_thai }}</span>
              {% endif %}
            </td>

            <td>
              {% if k.phan_hoi %}
                {{ k.phan_hoi }}
              {% else %}
                <em>Ch∆∞a c√≥ ph·∫£n h·ªìi</em>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="10" class="empty-text">
              Hi·ªán t·∫°i b·∫°n ch∆∞a c√≥ khi·∫øu n·∫°i n√†o.
            </td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
